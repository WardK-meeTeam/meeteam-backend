# language: ko

@acceptance @file
Feature: 파일 업로드
  회원이 프로필 사진이나 프로젝트 이미지를 안전하게 업로드할 수 있어야 한다.

  배경:
    먼저 "홍길동" 회원이 로그인한 상태이다

  # ==========================================================================
  # 정상 업로드 시나리오
  # ==========================================================================

  @upload @happy-path
  시나리오: JPG 이미지를 프로필 사진으로 업로드할 수 있다
    만약 "홍길동"이 "profile.jpg" 파일을 프로필 사진으로 업로드하면
    그러면 업로드에 성공한다
    그리고 "홍길동"의 프로필 사진이 변경된다

  @upload @happy-path
  시나리오: PNG 이미지를 프로젝트 썸네일로 업로드할 수 있다
    먼저 "홍길동"이 "AI 챗봇 개발" 프로젝트의 팀장이다
    만약 "홍길동"이 "thumbnail.png" 파일을 프로젝트 썸네일로 업로드하면
    그러면 업로드에 성공한다
    그리고 프로젝트 썸네일이 설정된다

  @upload @happy-path
  시나리오: GIF 이미지를 업로드할 수 있다
    만약 "홍길동"이 "animation.gif" 파일을 프로필 사진으로 업로드하면
    그러면 업로드에 성공한다

  # ==========================================================================
  # 파일 형식 검증 시나리오
  # ==========================================================================

  @validation @error-case
  시나리오: 실행 파일은 업로드할 수 없다
    만약 "홍길동"이 "malware.exe" 파일을 업로드하면
    그러면 업로드가 거부된다
    그리고 "지원하지 않는 파일 형식입니다" 메시지를 확인한다

  @validation @error-case
  시나리오: 압축 파일은 업로드할 수 없다
    만약 "홍길동"이 "archive.zip" 파일을 업로드하면
    그러면 업로드가 거부된다
    그리고 "지원하지 않는 파일 형식입니다" 메시지를 확인한다

  @validation @error-case
  시나리오: 스크립트 파일은 업로드할 수 없다
    만약 "홍길동"이 "script.js" 파일을 업로드하면
    그러면 업로드가 거부된다
    그리고 "지원하지 않는 파일 형식입니다" 메시지를 확인한다

  @validation @edge-case
  시나리오: 확장자를 위장한 파일은 업로드할 수 없다
    만약 "홍길동"이 "image.jpg.exe" 파일을 업로드하면
    그러면 업로드가 거부된다
    그리고 "지원하지 않는 파일 형식입니다" 메시지를 확인한다

  # ==========================================================================
  # 파일 크기 검증 시나리오
  # ==========================================================================

  @validation @error-case
  시나리오: 최대 용량을 초과한 파일은 업로드할 수 없다
    먼저 최대 허용 용량은 5MB이다
    만약 "홍길동"이 10MB 크기의 "large_image.jpg" 파일을 업로드하면
    그러면 업로드가 거부된다
    그리고 "파일 크기가 너무 큽니다 (최대 5MB)" 메시지를 확인한다

  @validation @edge-case
  시나리오: 최대 용량과 정확히 같은 크기의 파일은 업로드할 수 있다
    먼저 최대 허용 용량은 5MB이다
    만약 "홍길동"이 5MB 크기의 "exact_size.jpg" 파일을 업로드하면
    그러면 업로드에 성공한다

  @validation @edge-case
  시나리오: 빈 파일은 업로드할 수 없다
    만약 "홍길동"이 0KB 크기의 "empty.jpg" 파일을 업로드하면
    그러면 업로드가 거부된다
    그리고 "파일이 비어있습니다" 메시지를 확인한다

  # ==========================================================================
  # 권한 검증 시나리오
  # ==========================================================================

  @permission @error-case
  시나리오: 로그인하지 않으면 파일을 업로드할 수 없다
    먼저 "비회원"이 로그인하지 않은 상태이다
    만약 "비회원"이 "profile.jpg" 파일을 업로드하면
    그러면 업로드가 거부된다
    그리고 "로그인이 필요합니다" 메시지를 확인한다

  @permission @error-case
  시나리오: 다른 사람의 프로필 사진을 변경할 수 없다
    먼저 "김철수" 회원이 존재한다
    만약 "홍길동"이 "김철수"의 프로필 사진을 변경하려고 하면
    그러면 업로드가 거부된다
    그리고 "권한이 없습니다" 메시지를 확인한다

  @permission @error-case
  시나리오: 팀장이 아니면 프로젝트 썸네일을 변경할 수 없다
    먼저 "홍길동"이 "AI 챗봇 개발" 프로젝트의 일반 멤버이다
    만약 "홍길동"이 프로젝트 썸네일을 변경하려고 하면
    그러면 업로드가 거부된다
    그리고 "권한이 없습니다" 메시지를 확인한다

# language: ko

@acceptance @auth
기능: 회원 인증
  MeeTeam 서비스를 이용하기 위해 회원은 로그인하고 안전하게 로그아웃할 수 있어야 한다.

  배경:
    먼저 "홍길동" 회원이 다음 정보로 가입되어 있다:
      | 이메일              | 비밀번호      |
      | hong@meeteam.com   | password123  |

  # ==========================================================================
  # 로그인 시나리오
  # ==========================================================================

  @login @happy-path
  시나리오: 올바른 정보로 로그인하면 서비스를 이용할 수 있다
    만약 "홍길동"이 이메일 "hong@meeteam.com"과 비밀번호 "password123"으로 로그인을 시도하면
    그러면 로그인에 성공한다
    그리고 "홍길동"은 인증 토큰을 발급받는다
    그리고 "홍길동"은 MeeTeam 서비스를 이용할 수 있다

  @login @error-case
  시나리오: 잘못된 비밀번호로 로그인하면 실패한다
    만약 "홍길동"이 이메일 "hong@meeteam.com"과 비밀번호 "wrongpassword"으로 로그인을 시도하면
    그러면 로그인에 실패한다
    그리고 "이메일 또는 비밀번호가 올바르지 않습니다" 메시지를 확인한다

  @login @error-case
  시나리오: 가입하지 않은 이메일로 로그인하면 실패한다
    만약 "미가입자"가 이메일 "unknown@meeteam.com"과 비밀번호 "anypassword"으로 로그인을 시도하면
    그러면 로그인에 실패한다
    그리고 "이메일 또는 비밀번호가 올바르지 않습니다" 메시지를 확인한다

  @login @edge-case
  시나리오: 이메일을 입력하지 않으면 로그인할 수 없다
    만약 "홍길동"이 이메일 없이 비밀번호 "password123"만으로 로그인을 시도하면
    그러면 로그인에 실패한다
    그리고 "이메일을 입력해주세요" 메시지를 확인한다

  @login @edge-case
  시나리오: 비밀번호를 입력하지 않으면 로그인할 수 없다
    만약 "홍길동"이 이메일 "hong@meeteam.com"만으로 로그인을 시도하면
    그러면 로그인에 실패한다
    그리고 "비밀번호를 입력해주세요" 메시지를 확인한다

  # ==========================================================================
  # 토큰 재발급 시나리오
  # ==========================================================================

  @token-refresh @happy-path
  시나리오: 인증 토큰이 만료되면 자동으로 재발급받을 수 있다
    먼저 "홍길동"이 로그인한 상태이다
    그리고 "홍길동"의 인증 토큰이 만료되었다
    만약 "홍길동"이 토큰 재발급을 요청하면
    그러면 새로운 인증 토큰을 발급받는다
    그리고 "홍길동"은 계속해서 서비스를 이용할 수 있다

  @token-refresh @error-case
  시나리오: 리프레시 토큰이 없으면 재발급받을 수 없다
    먼저 "홍길동"이 리프레시 토큰 없이 토큰 재발급을 요청하면
    그러면 토큰 재발급에 실패한다
    그리고 "다시 로그인해주세요" 메시지를 확인한다

  @token-refresh @edge-case
  시나리오: 리프레시 토큰도 만료되면 다시 로그인해야 한다
    먼저 "홍길동"이 로그인한 상태이다
    그리고 "홍길동"의 리프레시 토큰이 만료되었다
    만약 "홍길동"이 토큰 재발급을 요청하면
    그러면 토큰 재발급에 실패한다
    그리고 "세션이 만료되었습니다. 다시 로그인해주세요" 메시지를 확인한다

  # ==========================================================================
  # 로그아웃 시나리오
  # ==========================================================================

  @logout @happy-path
  시나리오: 로그아웃하면 서비스 이용이 차단된다
    먼저 "홍길동"이 로그인한 상태이다
    만약 "홍길동"이 로그아웃을 요청하면
    그러면 로그아웃에 성공한다
    그리고 "홍길동"의 인증 토큰은 더 이상 유효하지 않다
    그리고 "홍길동"은 보호된 서비스에 접근할 수 없다

  @logout @oauth @happy-path
  시나리오: OAuth 로그인 사용자가 로그아웃하면 소셜 계정 연결도 해제된다
    먼저 "김영희"가 Google 계정으로 로그인한 상태이다
    만약 "김영희"가 로그아웃을 요청하면
    그러면 로그아웃에 성공한다
    그리고 Google OAuth 토큰이 철회된다
    그리고 "김영희"는 다시 소셜 로그인이 필요하다

  @logout @edge-case
  시나리오: 이미 로그아웃한 토큰으로 API를 호출하면 거부된다
    먼저 "홍길동"이 로그인 후 로그아웃한 상태이다
    만약 "홍길동"이 이전에 발급받은 토큰으로 프로젝트 목록을 조회하면
    그러면 요청이 거부된다
    그리고 "인증이 필요합니다" 메시지를 확인한다

  # ==========================================================================
  # 회원가입 시나리오
  # ==========================================================================

  @signup @happy-path
  시나리오: 새로운 회원이 가입할 수 있다
    만약 다음 정보로 회원가입을 시도하면:
      | 이름     | 이메일               | 비밀번호      | 나이 | 성별   |
      | 박철수   | park@meeteam.com    | secure123    | 25  | MALE   |
    그러면 회원가입에 성공한다
    그리고 "박철수" 회원이 생성된다
    그리고 "박철수"은 로그인할 수 있다

  @signup @error-case
  시나리오: 이미 가입된 이메일로는 가입할 수 없다
    만약 다음 정보로 회원가입을 시도하면:
      | 이름     | 이메일              | 비밀번호      |
      | 가짜홍길동 | hong@meeteam.com   | newpassword  |
    그러면 회원가입에 실패한다
    그리고 "이미 존재하는 이메일 입니다" 메시지를 확인한다

  @signup @edge-case
  시나리오: 비밀번호가 너무 짧으면 가입할 수 없다
    만약 다음 정보로 회원가입을 시도하면:
      | 이름     | 이메일               | 비밀번호  |
      | 박철수   | park@meeteam.com    | 123      |
    그러면 회원가입에 실패한다
    그리고 "비밀번호는 최소 8자 이상이어야 합니다" 메시지를 확인한다

  # ==========================================================================
  # OAuth 로그인 시나리오
  # ==========================================================================

  @oauth @happy-path
  시나리오: 기존 회원이 OAuth 로그인을 시도하면 토큰을 발급받는다
    먼저 "김영희"가 Google 계정으로 가입한 기존 회원이다
    그리고 "김영희"가 받은 OAuth 인증 코드는 "valid-code-for-existing-user"이다
    만약 "김영희"가 토큰 교환을 요청하면
    그러면 로그인에 성공한다
    그리고 "김영희"은 인증 토큰을 발급받는다

  @oauth @happy-path
  시나리오: 신규 회원이 OAuth 회원가입을 완료하면 토큰을 발급받는다
    먼저 "새사용자"가 받은 OAuth 인증 코드는 "valid-code-for-new-user"이다
    만약 "새사용자"가 다음 정보로 OAuth 회원가입을 시도하면:
      | 이름     | 나이 | 성별   | 분야     | 기술스택       |
      | 새사용자  | 20  | MALE   | 백엔드    | Java, Spring  |
    그러면 회원가입에 성공한다
    그리고 "새사용자"은 인증 토큰을 발급받는다
